# ğŸ“‹ ZimmerBot Backlog
### ×¢×‘×•×“×” ××¡×•×“×¨×ª, ×©×œ×‘ ××—×¨×™ ×©×œ×‘, ×‘×œ×™ ×œ×”×ª×¤×–×¨

> ğŸ“š **×§×™×©×•×¨ ×œ×ª×™×¢×•×“ ×”××œ×:** [README.md](./README.md) | [README_FULL.md](./docs/README_FULL.md)

---

## ğŸ¯ ××¦×‘ × ×•×›×—×™ (×××ª ×˜×›× ×™×ª)

### âœ… Stage 1-4 - ×§×™×™××™× ×•×¢×•×‘×“×™×
| ×©×œ×‘ | ×ª×™××•×¨ | ×¡×˜×˜×•×¡ |
|-----|--------|--------|
| **Stage 1** | DB Schema ×•×‘×“×™×§×•×ª | ğŸŸ¢ Done |
| **Stage 2** | ×–××™× ×•×ª ×•×”×–×× ×” ×œ×™×•××Ÿ | ğŸŸ¢ Done |
| **Stage 3** | `/quote` ×¢× PricingEngine + breakdown | ğŸŸ¢ Done |
| **Stage 4** | Hold ××œ× (API + Calendar + DB + Redis fallback) | ğŸŸ¢ Done |

### â³ ×—×¡×¨ (×”×©×œ×‘×™× ×”×‘××™×)
- âœ… Agent Chat (A1-A4 ×”×•×©×œ××• ×‘××œ×•××: DB, Endpoint, Tool Routing, Knowledge. ×¢×§×¨×•× ×•×ª ×”×¡×•×›×Ÿ ×”×—×›× ××•×’×“×¨×™× ×•×××•××©×™×)
- ğŸŸ¡ Host Console (B1-B2) - ×”×©×œ×‘ ×”×‘×! ğŸ¯
- ğŸŸ¡ ×ª×©×œ×•××™× (×—×œ×§×™ - ×“××• ×¢×•×‘×“)
- ğŸŸ¡ ×”×•×“×¢×•×ª ×•×ª×–×›×•×¨×•×ª (×—×œ×§×™ - ×”×•×“×¢×” ××—×ª ×¢×•×‘×“×ª)
- âœ… ××•×˜×•××¦×™×•×ª n8n (×”×•×©×œ×)
- âœ… Agent ×§×•×œ×™ (×”×•×©×œ×)

---

## ğŸš€ ×©×œ×‘ A: Agent ×˜×§×¡×˜ (×”×›×™ ×—×©×•×‘!)

### A1. ğŸ’¾ DB ×œ×©×™×—×•×ª (×—×“×©)

#### **××©×™××” 1:** ×™×¦×™×¨×ª ×˜×‘×œ××•×ª ×œ×©×™×—×•×ª
```sql
×˜×‘×œ××•×ª × ×“×¨×©×•×ª:
â”œâ”€â”€ conversations      # ×©×™×—×•×ª
â”œâ”€â”€ messages          # ×”×•×“×¢×•×ª ×‘×©×™×—×”
â”œâ”€â”€ faq               # ×©××œ×•×ª ×××•×©×¨×•×ª
â””â”€â”€ escalations       # ×“×•×¨×© ×‘×¢×œ×™×
```

**×ª× ××™ ×¡×™×•×:**
- [x] ×§×•×‘×¥ migration SQL × ×•×¦×¨ (`database/migration_agent_tables.sql`)
- [x] ×‘×“×™×§×” ×©××›× ×™×¡×™× ×©×™×—×” ×•×”×•×“×¢×•×ª ×‘-DB (`database/check_agent_tables.py`)
- [x] ×›×œ ×”×‘×“×™×§×•×ª ×¢×‘×¨×• (5/5)

---

#### **××©×™××” 2:** Audit ×œ×›×œ ×”×•×“×¢×”
**×ª× ××™ ×¡×™×•×:**
- [x] ×™×© ×¨×™×©×•× ×¤×¢×•×œ×” (audit log) ×œ×›×œ message ×©× ×©××¨

---

### A2. ğŸ¤– Endpoint Agent

#### **××©×™××” 3:** ×™×¦×™×¨×ª `POST /agent/chat`

**×§×œ×˜:**
```json
{
  "message": "string",
  "customer_id": "string (optional)",
  "phone": "string (optional)",
  "channel": "web|whatsapp|voice",
  "context": {
    "check_in": "YYYY-MM-DD (optional)",
    "check_out": "YYYY-MM-DD (optional)",
    "guests": "int (optional)",
    "cabin_id": "string (optional)"
  }
}
```

**×¤×œ×˜:**
```json
{
  "answer": "string",
  "actions_suggested": ["availability", "quote", "hold", "book"],
  "confidence": 0.95,
  "conversation_id": "uuid"
}
```

**×ª× ××™ ×¡×™×•×:**
- [x] ×¢×•×‘×“ ×‘-Swagger UI (`POST /agent/chat`)
- [x] ×©×•××¨ ×©×™×—×” ×‘-DB (conversations + messages)
- [x] Audit log ×œ×›×œ ×”×•×“×¢×”
- [x] Pydantic models (ChatRequest, ChatResponse)

---

#### **××©×™××” 4:** Agent Tool Routing (×©×¨×ª ×‘×œ×‘×“)

**×œ×•×’×™×§×”:**
- ×× ×¦×¨×™×š ×–××™× ×•×ª â†’ ×§×•×¨× `check_availability()`
- ×× ×¦×¨×™×š ××—×™×¨ â†’ ×§×•×¨× `calculate_quote()`
- ×× ×¦×¨×™×š hold â†’ ×§×•×¨× `create_hold()`
- ×× ×¦×¨×™×š ×”×–×× ×” â†’ ×§×•×¨× `create_booking()`

**×ª× ××™ ×¡×™×•×:**
- [x] ×œ×¤×—×•×ª **3 ×ª×¨×—×™×©×™×** ×¢×•×‘×“×™× ××§×¦×” ×œ×§×¦×”
  1. ×©××™×œ×ª×ª ×–××™× ×•×ª âœ…
  2. ×§×‘×œ×ª ×”×¦×¢×ª ××—×™×¨ âœ…
  3. ×™×¦×™×¨×ª Hold âœ…
- [x] Agent class × ×•×¦×¨ (`src/agent.py`)
- [x] ×—×™×‘×•×¨ ×œ×›×œ×™× ×§×™×™××™× (availability, quote, hold)

---

### A4. ğŸ“š Knowledge ×‘×¡×™×¡×™

#### **××©×™××” 5:** ×§×•×‘×¥/×˜×‘×œ×ª Business Facts

**× ×ª×•× ×™× × ×“×¨×©×™×:**
```yaml
Business Facts:
  - ×©×¢×•×ª ×¦'×§ ××™×Ÿ: "15:00"
  - ×©×¢×•×ª ×¦'×§ ×××•×˜: "11:00"
  - ××“×™× ×™×•×ª ×‘×™×˜×•×œ: "24 ×©×¢×•×ª ××¨××©"
  - ×›×ª×•×‘×ª: "×¨×—×•×‘ X, ×™×™×©×•×‘ Y"
  - ×—× ×™×”: "×›×Ÿ, ×—× ×™×” ×¤×¨×˜×™×ª"
  - ×—×™×•×ª ××—××“: "×œ× ××•×ª×¨×•×ª"
  - ×›×©×¨×•×ª: "×œ×"
  - WiFi: "×›×Ÿ, ×—×™× ×"
```

**×ª× ××™ ×¡×™×•×:**
- [x] ×˜×‘×œ×ª `business_facts` × ×•×¦×¨×” ×‘-DB
- [x] ×¤×•× ×§×¦×™×•×ª ×§×¨×™××”/×›×ª×™×‘×” ×‘-`src/db.py`
- [x] Agent ×¢×•× ×” ××ª×•×š facts **×‘×œ×™ ×œ×”××¦×™× ××™×“×¢**
- [x] Endpoint `GET /admin/business-facts` ×•-`POST /admin/business-facts`

---

#### **××©×™××” 6:** FAQ ×××•×©×¨ ×‘×œ×‘×“

**×ª×”×œ×™×š:**
1. Agent ×§×•×“× ××—×¤×© FAQ ×××•×©×¨
2. ×× ××™×Ÿ FAQ â†’ ×¢×•× ×” ×•××¡××Ÿ ×›**"××•×¦×¢"** (pending approval)
3. ×‘×¢×œ ×”×¦×™××¨ ×××©×¨/×“×•×—×” ×ª×©×•×‘×•×ª ××•×¦×¢×•×ª

**×ª× ××™ ×¡×™×•×:**
- [x] Agent ××—×¤×© FAQ ×××•×©×¨ ×œ×¤× ×™ ×ª×©×•×‘×”
- [x] Agent ××¡××Ÿ ×ª×©×•×‘×•×ª ×›-"××•×¦×¢" ×× ××™×Ÿ FAQ
- [x] Endpoint `GET /admin/faq/pending` - ×¨×©×™××ª FAQs ×××ª×™× ×™×
- [x] Endpoint `POST /admin/faq/approve` - ××™×©×•×¨/×“×—×™×™×” ×©×œ FAQ
- [x] Agent ×œ× ××©×ª××© ×‘×ª×©×•×‘×•×ª ×œ× ×××•×©×¨×•×ª

---

## ğŸ–¥ï¸ ×©×œ×‘ B: Host Console (×©×œ×™×˜×” ××œ××”)

### B1. ğŸ”Œ Admin API

| ××©×™××” | Endpoint | ×ª×™××•×¨ |
|-------|----------|--------|
| **7** | `GET /admin/conversations` | ×¨×©×™××ª ×©×™×—×•×ª |
| **8** | `GET /admin/conversations/{id}` | ×¤×¨×˜×™ ×©×™×—×” ××—×ª |
| **9** | `POST /admin/send-reply` | ×©×œ×™×—×ª ×ª×©×•×‘×” ×™×“× ×™×ª |
| **10** | `POST /admin/faq` | ×™×¦×™×¨×”/××™×©×•×¨ FAQ |
| **11** | `GET /admin/analytics` | ×¡×˜×˜×™×¡×˜×™×§×•×ª |

**×ª× ××™ ×¡×™×•×:**
- [ ] ×”×›×œ ×¢×•×‘×“ ×‘-**Swagger UI**
- [ ] ×”×›×œ ××—×•×‘×¨ ×œ-**DB**

---

### B2. ğŸ¨ Lovable ×—×™×‘×•×¨ ×‘×¤×•×¢×œ

#### **××©×™××” 12:** Host Inbox UI
- ××—×•×‘×¨ ×œ-`GET /admin/conversations`
- ××¦×™×’ ×¨×©×™××ª ×©×™×—×•×ª ×¢×:
  - ×œ×§×•×—
  - ×–××Ÿ ××—×¨×•×Ÿ
  - ×¡×˜×˜×•×¡ (×××ª×™×Ÿ, × ×¢× ×”, × ×¡×’×¨)

---

#### **××©×™××” 13:** ×—×œ×•×Ÿ ×©×™×—×”
- ××—×•×‘×¨ ×œ-`GET /admin/conversations/{id}`
- ××¦×™×’:
  - ×”×™×¡×˜×•×¨×™×™×ª ×©×™×—×”
  - ×ª×©×•×‘×” ××•×¦×¢×ª ×©×œ Agent
  - ××¤×©×¨×•×ª ×¢×¨×™×›×”

---

#### **××©×™××” 14:** ×›×¤×ª×•×¨×™× ×¤×¢×•×œ×”
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“¤ ×©×œ×—                  â”‚
â”‚ âœï¸ ×¢×¨×•×š ×•×©×œ×—            â”‚
â”‚ â­ ×©××•×¨ ×›-FAQ           â”‚
â”‚ ğŸš¨ ×“×•×¨×© ×‘×¢×œ×™×          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**×ª× ××™ ×¡×™×•×:**
- [ ] ×‘×¢×œ ×¦×™××¨ ×™×›×•×œ ×œ× ×”×œ ×©×™×—×•×ª **××§×¦×” ×œ×§×¦×”** ××”-UI

---

## ğŸ’¬ ×©×œ×‘ C: Guest Portal (×–×¨×™××” ××œ××”)

#### **××©×™××” 15:** Guest Chat UI
- ××—×•×‘×¨ ×œ-`POST /agent/chat`
- ×××©×§ ×¦'××˜ responsive
- ×©×œ×™×—×” ×•×”×¦×’×ª ×ª×©×•×‘×•×ª ×‘×–××Ÿ ×××ª

---

#### **××©×™××” 16:** ×ª×¨×—×™×© Full Flow
```mermaid
graph LR
    A[××•×¨×— ×©×•××œ ×–××™× ×•×ª] --> B[Agent ××¦×™×’ ××•×¤×¦×™×•×ª]
    B --> C[××•×¨×— ××‘×§×© ××—×™×¨]
    C --> D[Agent ××—×–×™×¨ quote]
    D --> E[××•×¨×— ×™×•×¦×¨ Hold]
    E --> F[××•×¨×— ××‘×¦×¢ ×”×–×× ×”]
    F --> G[âœ… ×”×–×× ×” ×××•×©×¨×ª]
```

**×ª× ××™ ×¡×™×•×:**
- [ ] ×¢×•×‘×“ ××•×œ **API ×××™×ª×™**, ×œ× ×“××•
- [ ] ×›×œ ×”×©×œ×‘×™× ×¢×•×‘×“×™× ×‘×¨×¦×£

---

## ğŸ’³ ×©×œ×‘ D: ×ª×©×œ×•××™× (Stage 5)

| ××©×™××” | ×ª×™××•×¨ | ××©×š ××©×•×¢×¨ |
|-------|--------|-----------|
| **17** | ×‘×—×™×¨×ª ×¡×¤×§ (Stripe ××• ×™×©×¨××œ×™) | 1 ×™×•× |
| **18** | ×™×¦×™×¨×ª Payment Intent/Invoice | 2 ×™××™× |
| **19** | Webhook ×××•××ª | 1 ×™×•× |
| **20** | ×¢×“×›×•×Ÿ DB: transactions + booking status | 1 ×™×•× |
| **21** | Convert HOLD â†’ CONFIRMED ×¨×§ ××—×¨×™ ×ª×©×œ×•× | 1 ×™×•× |

**×ª× ××™ ×¡×™×•×:**
- [x] ×ª×©×œ×•× ×‘×“××• ×¢×•×‘×“
- [x] ×”×–×× ×” × ×¡×’×¨×ª **×¨×§ ×œ××—×¨ webhook ×ª×§×™×Ÿ**
- [x] Rollback ××•×˜×•××˜×™ ×× ×ª×©×œ×•× × ×›×©×œ

---

## ğŸ“¨ ×©×œ×‘ E: ×”×•×“×¢×•×ª ×•×ª×–×›×•×¨×•×ª (Stage 6)

#### **××©×™××” 22:** ×ª×‘× ×™×•×ª ×”×•×“×¢×”

```yaml
×ª×‘× ×™×•×ª × ×“×¨×©×•×ª:
  1. ××™×©×•×¨ ×”×–×× ×”:
     - ×©× ×œ×§×•×—
     - ×ª××¨×™×›×™×
     - ×¡×›×•×
     - ×§×™×©×•×¨ ×œ×¤×¨×˜×™×
  
  2. ×ª×–×›×•×¨×ª 3 ×™××™× ×œ×¤× ×™:
     - ×”× ×—×™×•×ª ×”×’×¢×”
     - ×¦×§ ××™×Ÿ
     - ××™×© ×§×©×¨
  
  3. ×™×•× ×”×”×’×¢×”:
     - ×§×•×“ ×›× ×™×¡×” (×× ×¨×œ×•×•× ×˜×™)
     - ××¡×¤×¨ ×˜×œ×¤×•×Ÿ ×—×™×¨×•×
  
  4. ××—×¨×™ ×™×¦×™××”:
     - ×ª×•×“×”
     - ×‘×§×©×” ×œ×—×•×•×ª ×“×¢×ª
     - ×§×•×“ ×”× ×—×” ×œ×”×–×× ×” ×”×‘××”
```

---

#### **××©×™××” 23:** ×©×œ×™×—×” ×‘×¢×¨×•×¥ ×¨××©×•×Ÿ
- ××™××™×™×œ **××•** WhatsApp (×œ×¤×™ ×”×¢×“×¤×ª ×œ×§×•×—)
- Fallback: ×× ××—×“ × ×›×©×œ, × ×¡×” ××ª ×”×©× ×™

---

#### **××©×™××” 24:** ×¨×™×©×•× notifications ×‘-DB
```sql
notifications:
  - conversation_id
  - type (confirmation, reminder, followup)
  - channel (email, whatsapp, sms)
  - status (sent, failed, opened)
  - sent_at
```

**×ª× ××™ ×¡×™×•×:**
- [x] **×”×•×“×¢×” ××—×ª ××•×˜×•××˜×™×ª** ×¢×•×‘×“×ª ××§×¦×” ×œ×§×¦×”
- [x] × ×¨×©××ª ×‘-DB ×¢× ×¡×˜×˜×•×¡

---

## ğŸ”„ ×©×œ×‘ F: n8n ××•×˜×•××¦×™×•×ª (×‘××§×‘×™×œ ××—×¨×™ Host)

| ××©×™××” | ××•×˜×•××¦×™×” | ×˜×¨×™×’×¨ |
|-------|-----------|--------|
| **25** | ×¡×™×›×•× ×™×•××™ ×œ×‘×¢×œ ×¦×™××¨ | 08:00 ×‘×•×§×¨ |
| **26** | ×”×ª×¨××” ×¢×œ ×©×™×—×” ×©×œ× × ×¢× ×ª×” | X ×“×§×•×ª ×œ×œ× ××¢× ×” |
| **27** | ×™×¦×™×¨×ª ××©×™××” ×œ×—×¨×™×’×™× | ×–×™×”×•×™ ×‘×¢×™×” |

**×ª× ××™ ×¡×™×•×:**
- [x] **2 ××•×˜×•××¦×™×•×ª ×¤×¢×™×œ×•×ª** ×•××“×•×•×—×•×ª
- [x] ×œ×•×’×™× ×‘-n8n
- [x] ×”×ª×¨××•×ª ××’×™×¢×•×ª ×‘×¤×•×¢×œ

---

## ğŸ™ï¸ ×©×œ×‘ G: Agent ×§×•×œ×™ (Stage 8)

```mermaid
graph LR
    A[ğŸ“ Voice Inbound] --> B[ğŸ¤ ×ª××œ×•×œ Speech-to-Text]
    B --> C[ğŸ¤– POST /agent/chat]
    C --> D[ğŸ’¬ ×§×‘×œ×ª ×ª×©×•×‘×”]
    D --> E[ğŸ”Š TTS]
    E --> F[ğŸ“ ×”×©××¢×” ×œ×œ×§×•×—]
```

| ××©×™××” | ×ª×™××•×¨ | ×›×œ×™× |
|-------|--------|------|
| **28** | Voice inbound â†’ ×ª××œ×•×œ | Vapi / Bland.ai / Deepgram |
| **29** | POST /agent/chat | ×§×™×™× |
| **30** | ×ª×©×•×‘×” â†’ TTS | ElevenLabs / Google TTS |

**×ª× ××™ ×¡×™×•×:**
- [x] **×©×™×—×” ×§×•×œ×™×ª ××—×ª ××œ××”** ×¢×•×‘×“×ª
- [x] ×ª××œ×•×œ ××“×•×™×§ (>90%)
- [x] TTS ×˜×‘×¢×™ ×•××•×‘×Ÿ

---

## ğŸ“‚ ×§×‘×¦×™× ×—×©×•×‘×™× ×©×›×‘×¨ ×§×™×™××™×

### Backend
```
src/
â”œâ”€â”€ api_server.py         # FastAPI routes
â”œâ”€â”€ main.py               # Entry point
â”œâ”€â”€ pricing.py            # ×œ×•×’×™×§×ª ×ª××—×•×¨
â”œâ”€â”€ hold.py               # × ×™×”×•×œ holds
â”œâ”€â”€ db.py                 # ×—×™×‘×•×¨×™× ×œ-DB
â””â”€â”€ features_utils.py     # ×›×œ×™× ××©×•×ª×¤×™×
```

### Database
```
database/
â”œâ”€â”€ check_stage1.py       # ×‘×“×™×§×ª Stage 1
â”œâ”€â”€ check_stage2.py       # ×‘×“×™×§×ª Stage 2
â”œâ”€â”€ check_stage3.py       # ×‘×“×™×§×ª Stage 3
â””â”€â”€ check_stage4.py       # ×‘×“×™×§×ª Stage 4
```

### Tools & Docs
```
tools/
â””â”€â”€ features_picker.html  # ×‘×—×™×¨×ª ×ª×›×•× ×•×ª

docs/
â”œâ”€â”€ PROJECT_STATUS.md     # ×¡×˜×˜×•×¡ ×”×¤×¨×•×™×§×˜
â””â”€â”€ README_FULL.md        # ×ª×™×¢×•×“ ××œ×
```

---

## ğŸ¯ ×¡×“×¨ ×¢×‘×•×“×” ×™×•××™ ××•××œ×¥

1. **×ª××™×“ ×§×•×“× Endpoint ×•××– UI**
   - Backend ×§×•×“× â†’ Frontend ××—×¨ ×›×š
   - ×œ× ×œ×”×ª×—×™×œ UI ×œ×¤× ×™ ×©-API ×¢×•×‘×“

2. **×œ× ×¢×•×‘×¨×™× ×¡×¢×™×£ ×‘×œ×™ ××™×©×•×¨**
   - ×¡×™×™××ª ××©×™××”? âœ… ×¡××Ÿ
   - ×‘×“×•×§ ×ª× ××™ ×¡×™×•×
   - ×¢×‘×•×¨ ×œ××©×™××” ×”×‘××” ×¨×§ ××—×¨×™ ××™×©×•×¨

3. **×›×œ ×©×™×—×” × ×©××¨×ª ××”×™×•× ×”×¨××©×•×Ÿ**
   - Audit trail ××œ×
   - ×œ× ××•×—×§×™× ×”×™×¡×˜×•×¨×™×”
   - ×©××™×¨×” ×‘-DB + logs

---

## ğŸ“Š ×˜×‘×œ×ª ×¡×˜×˜×•×¡ ×›×œ×œ×™×ª

| ×©×œ×‘ | ×ª×™××•×¨ | ×¡×˜×˜×•×¡ | ××—×•×– ×”×©×œ××” |
|-----|--------|--------|------------|
| **Stage 1** | DB Schema | ğŸŸ¢ Done | 100% |
| **Stage 2** | ×–××™× ×•×ª ×•×”×–×× ×” | ğŸŸ¢ Done | 100% |
| **Stage 3** | ×ª××—×•×¨ | ğŸŸ¢ Done | 100% |
| **Stage 4** | Hold | ğŸŸ¢ Done | 100% |
| **Stage 5** | Agent Chat | ğŸŸ¢ Done | 100% |
| **Stage 6** | Host Console | ğŸŸ¡ Partial | 20% |
| **Stage 7** | ×ª×©×œ×•××™× | ğŸŸ¡ Partial | 60% |
| **Stage 8** | ×”×•×“×¢×•×ª | ğŸŸ¡ Partial | 50% |
| **Stage 9** | n8n | ğŸŸ¢ Done | 100% |
| **Stage 10** | Voice | ğŸŸ¢ Done | 100% |

---

<div align="center">

**ğŸ“Œ ×¢×“×›×•×Ÿ ××—×¨×•×Ÿ:** ×™× ×•××¨ 2026  
**ğŸ¯ ××©×™××” × ×•×›×—×™×ª:** ×©×œ×‘ B - Host Console (B1: Admin API)

[â¬†ï¸ ×—×–×¨×” ×œ××¢×œ×”](#-zimmerbot-backlog)

</div>
